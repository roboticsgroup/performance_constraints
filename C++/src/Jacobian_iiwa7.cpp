/*Symbolic Jacobian for KUKA IIWA 7 

Author: Fotis Dimeas
Copyright 2021 Fotios Dimeas
*/

#include <performance_constraints/performanceConstraints.h>

//Jacobian expressed on the tool frame
arma::mat PC::get_Jsym_body(const arma::vec jntvalues) {
	
	arma::mat J(6,7);
	J.zeros(); //very important to initialize to zero!

	double t1 = jntvalues.at(0);
	double t2 = jntvalues.at(1);
	double t3 = jntvalues.at(2);
	double t4 = jntvalues.at(3);
	double t5 = jntvalues.at(4);
	double t6 = jntvalues.at(5);
	double t7 = jntvalues.at(6);

	double t9 = cos(t7);
	double t10 = cos(t4);
	double t11 = sin(t5);
	double t12 = sin(t7);
	double t13 = t11*t12;
	double t14 = cos(t5);
	double t15 = cos(t6);
	double t20 = t9*t14*t15;
	double t16 = t13-t20;
	double t17 = sin(t4);
	double t18 = sin(t6);
	double t19 = sin(t3);
	double t21 = t10*t16;
	double t39 = t9*t17*t18;
	double t22 = t21-t39;
	double t23 = cos(t3);
	double t24 = t12*t14;
	double t25 = t9*t11*t15;
	double t26 = t24+t25;
	double t27 = cos(t1);
	double t28 = cos(t2);
	double t29 = sin(t2);
	double t30 = t15*(8.3E1/5.0E2);
	double t31 = t30+2.0/5.0;
	double t32 = sin(t1);
	double t33 = t17*t31;
	double t47 = t10*t14*t18*(8.3E1/5.0E2);
	double t34 = t33-t47;
	double t35 = t16*t17;
	double t36 = t9*t10*t18;
	double t37 = t35+t36;
	double t38 = t29*t37;
	double t40 = t22*t23;
	double t41 = t19*t26;
	double t42 = t40+t41;
	double t43 = t28*t42;
	double t44 = t38+t43;
	double t45 = t19*t22;
	double t89 = t23*t26;
	double t46 = t45-t89;
	double t48 = t19*t34;
	double t59 = t11*t18*t23*(8.3E1/5.0E2);
	double t49 = t48-t59;
	double t50 = t23*t34;
	double t51 = t11*t18*t19*(8.3E1/5.0E2);
	double t52 = t50+t51;
	double t53 = t10*t31;
	double t54 = t14*t17*t18*(8.3E1/5.0E2);
	double t55 = t53+t54+2.0/5.0;
	double t57 = t28*t52;
	double t58 = t29*t55;
	double t56 = t57-t58;
	double t60 = t27*t49;
	double t61 = t32*t56;
	double t62 = t60+t61;
	double t63 = t9*t11;
	double t64 = t12*t14*t15;
	double t65 = t63+t64;
	double t66 = t10*t65;
	double t67 = t12*t17*t18;
	double t68 = t66+t67;
	double t69 = t9*t14;
	double t73 = t11*t12*t15;
	double t70 = t69-t73;
	double t71 = t32*t49;
	double t72 = t19*t68;
	double t91 = t23*t70;
	double t74 = t72-t91;
	double t75 = t17*t65;
	double t84 = t10*t12*t18;
	double t76 = t75-t84;
	double t77 = t29*t76;
	double t78 = t23*t68;
	double t79 = t19*t70;
	double t80 = t78+t79;
	double t81 = t28*t80;
	double t82 = t77+t81;
	double t83 = t71-t27*t56;
	double t85 = t29*t52;
	double t86 = t28*t55;
	double t87 = t85+t86;
	double t88 = t28*t37;
	double t90 = t28*t76;
	double t92 = t15*t17;
	double t93 = t92-t10*t14*t18;
	double t94 = t10*t15;
	double t95 = t14*t17*t18;
	double t96 = t94+t95;
	J.at(0,0) = -t62*(t27*t44-t32*t46)-t83*(t27*t46+t32*t44);
	J.at(0,1) = -t44*t87-t56*(t88-t29*t42);
	J.at(0,2) = t9*t11*t17*(-8.3E1/5.0E2)+t10*t12*t18*(8.3E1/5.0E2)-t12*t14*t17*(2.0/5.0)-t9*t11*t15*t17*(2.0/5.0)-t12*t14*t15*t17*(8.3E1/5.0E2);
	J.at(0,3) = t9*t14*(-8.3E1/5.0E2)+t11*t12*(2.0/5.0)-t9*t14*t15*(2.0/5.0)+t11*t12*t15*(8.3E1/5.0E2);
	J.at(0,4) = t12*t18*(8.3E1/5.0E2);
	J.at(0,5) = t9*(8.3E1/5.0E2);
	J.at(1,0) = t62*(t32*t74-t27*t82)-t83*(t27*t74+t32*t82);
	J.at(1,1) = -t82*t87-t56*(t90-t29*t80);
	J.at(1,2) = t9*t10*t18*(8.3E1/5.0E2)-t9*t14*t17*(2.0/5.0)+t11*t12*t17*(8.3E1/5.0E2)-t9*t14*t15*t17*(8.3E1/5.0E2)+t11*t12*t15*t17*(2.0/5.0);
	J.at(1,3) = t9*t11*(2.0/5.0)+t12*t14*(8.3E1/5.0E2)+t9*t11*t15*(8.3E1/5.0E2)+t12*t14*t15*(2.0/5.0);
	J.at(1,4) = t9*t18*(8.3E1/5.0E2);
	J.at(1,5) = t12*(-8.3E1/5.0E2);
	J.at(2,0) = t11*t17*t18*t28*(-2.0/5.0)+t14*t18*t19*t29*(2.0/5.0)-t15*t17*t19*t29*(2.0/5.0)+t11*t18*t23*t29*(2.0/5.0)+t10*t14*t18*t19*t29*(2.0/5.0)+t10*t11*t18*t23*t29*(2.0/5.0);
	J.at(2,1) = t11*t18*t19*(-2.0/5.0)+t14*t18*t23*(2.0/5.0)-t15*t17*t23*(2.0/5.0)-t10*t11*t18*t19*(2.0/5.0)+t10*t14*t18*t23*(2.0/5.0);
	J.at(2,2) = t11*t17*t18*(-2.0/5.0);
	J.at(2,3) = t14*t18*(-2.0/5.0);
	J.at(3,0) = -t88+t29*t42;
	J.at(3,1) = -t45+t89;
	J.at(3,2) = -t35-t36;
	J.at(3,3) = -t24-t25;
	J.at(3,4) = -t9*t18;
	J.at(3,5) = t12;
	J.at(4,0) = -t90+t29*t80;
	J.at(4,1) = -t72+t91;
	J.at(4,2) = -t75+t84;
	J.at(4,3) = -t69+t73;
	J.at(4,4) = t12*t18;
	J.at(4,5) = t9;
	J.at(5,0) = t29*(t23*t93+t11*t18*t19)+t28*t96;
	J.at(5,1) = -t19*t93+t11*t18*t23;
	J.at(5,2) = t96;
	J.at(5,3) = -t11*t18;
	J.at(5,4) = t15;
	J.at(5,6) = 1.0;

	return J;

}

//Jacobian expressed on the base frame
//// Simplified from Matlab
arma::mat PC::get_Jsym_spatial(const arma::vec jntvalues) {

	arma::mat J(6,7);
	J.zeros(); //very important to initialize to zero!

	double t1 = jntvalues.at(0);
	double t2 = jntvalues.at(1);
	double t3 = jntvalues.at(2);
	double t4 = jntvalues.at(3);
	double t5 = jntvalues.at(4);
	double t6 = jntvalues.at(5);
	double t7 = jntvalues.at(6);

	double t9 = sin(t6);
	double t10 = cos(t3);
	double t11 = cos(t6);
	double t12 = sin(t4);
	double t13 = t11*t12;
	double t14 = cos(t4);
	double t15 = cos(t5);
	double t27 = t9*t14*t15;
	double t16 = t13-t27;
	double t17 = sin(t3);
	double t18 = sin(t5);
	double t19 = cos(t1);
	double t20 = cos(t2);
	double t21 = sin(t2);
	double t22 = t11*(8.3E1/5.0E2);
	double t23 = t22+2.0/5.0;
	double t24 = sin(t1);
	double t25 = t12*t23;
	double t37 = t9*t14*t15*(8.3E1/5.0E2);
	double t26 = t25-t37;
	double t28 = t16*t17;
	double t47 = t9*t10*t18;
	double t29 = t28-t47;
	double t30 = t10*t16;
	double t31 = t9*t17*t18;
	double t32 = t30+t31;
	double t33 = t11*t14;
	double t34 = t9*t12*t15;
	double t35 = t33+t34;
	double t49 = t20*t32;
	double t50 = t21*t35;
	double t36 = t49-t50;
	double t38 = t17*t26;
	double t64 = t9*t10*t18*(8.3E1/5.0E2);
	double t39 = t38-t64;
	double t40 = t10*t26;
	double t41 = t9*t17*t18*(8.3E1/5.0E2);
	double t42 = t40+t41;
	double t43 = t14*t23;
	double t44 = t9*t12*t15*(8.3E1/5.0E2);
	double t45 = t43+t44+2.0/5.0;
	double t62 = t20*t42;
	double t63 = t21*t45;
	double t46 = t62-t63;
	double t48 = t24*t29;
	double t111 = t19*t36;
	double t51 = t48-t111;
	double t52 = cos(t7);
	double t53 = sin(t7);
	double t54 = t18*t53;
	double t56 = t11*t15*t52;
	double t55 = t54-t56;
	double t57 = t14*t55;
	double t71 = t9*t12*t52;
	double t58 = t57-t71;
	double t59 = t15*t53;
	double t60 = t11*t18*t52;
	double t61 = t59+t60;
	double t65 = t24*t39;
	double t107 = t19*t46;
	double t66 = t65-t107;
	double t67 = t12*t55;
	double t68 = t9*t14*t52;
	double t69 = t67+t68;
	double t70 = t21*t69;
	double t72 = t10*t58;
	double t73 = t17*t61;
	double t74 = t72+t73;
	double t75 = t20*t74;
	double t76 = t70+t75;
	double t77 = t10*t61;
	double t78 = t19*t39;
	double t79 = t24*t46;
	double t80 = t78+t79;
	double t83 = t17*t58;
	double t81 = t77-t83;
	double t82 = t19*t76;
	double t84 = t24*t81;
	double t85 = t82+t84;
	double t86 = t18*t52;
	double t87 = t11*t15*t53;
	double t88 = t86+t87;
	double t89 = t14*t88;
	double t90 = t9*t12*t53;
	double t91 = t89+t90;
	double t92 = t15*t52;
	double t98 = t11*t18*t53;
	double t93 = t92-t98;
	double t94 = t12*t88;
	double t110 = t9*t14*t53;
	double t95 = t94-t110;
	double t96 = t21*t95;
	double t97 = t10*t91;
	double t99 = t17*t93;
	double t100 = t97+t99;
	double t101 = t20*t100;
	double t102 = t96+t101;
	double t103 = t19*t102;
	double t104 = t10*t93;
	double t108 = t17*t91;
	double t109 = t104-t108;
	double t105 = t24*t109;
	double t106 = t103+t105;
	double t112 = t21*t42;
	double t113 = t20*t45;
	double t114 = t112+t113;
	double t115 = t11*t14*t15*t52;
	double t120 = t14*t18*t53;
	double t116 = t71+t115-t120;
	double t117 = t14*t18*t52;
	double t118 = t11*t14*t15*t53;
	double t119 = t90+t117+t118;
	double t121 = t17*t116;
	double t122 = t77+t121;
	double t123 = t24*t122;
	double t124 = t12*t18*t53;
	double t179 = t11*t12*t15*t52;
	double t125 = t68+t124-t179;
	double t126 = t21*t125;
	double t180 = t10*t116;
	double t216 = t73-t180;
	double t127 = t20*t216;
	double t128 = t126+t127;
	double t129 = t19*t128;
	double t130 = t123+t129;
	double t186 = t17*t119;
	double t131 = t104-t186;
	double t132 = t24*t131;
	double t133 = t12*t18*t52;
	double t134 = t11*t12*t15*t53;
	double t135 = -t110+t133+t134;
	double t136 = t21*t135;
	double t137 = t10*t119;
	double t138 = t99+t137;
	double t139 = t20*t138;
	double t140 = t136+t139;
	double t141 = t19*t140;
	double t142 = t132+t141;
	double t143 = t9*t14*t15*t17;
	double t191 = t11*t12*t17;
	double t144 = t47+t143-t191;
	double t145 = t10*t11*t12;
	double t192 = t9*t10*t14*t15;
	double t146 = t31+t145-t192;
	double t193 = t20*t146;
	double t147 = t50-t193;
	double t148 = t19*t147;
	double t149 = t148-t24*t144;
	double t150 = t19*t29;
	double t151 = t24*t36;
	double t152 = t150+t151;
	double t153 = t51*t80;
	double t208 = t66*t152;
	double t154 = t153-t208;
	double t155 = t19*t81;
	double t156 = t24*(t77-t83);
	double t157 = t82+t156;
	double t158 = t24*t102;
	double t162 = t19*t109;
	double t159 = t158-t162;
	double t160 = t24*(t104-t108);
	double t161 = t103+t160;
	double t163 = t159*(t65-t107);
	double t164 = t76*t114;
	double t165 = t20*t69;
	double t209 = t21*t74;
	double t166 = t165-t209;
	double t167 = t46*t166;
	double t168 = t164+t167;
	double t210 = t24*t76;
	double t169 = t155-t210;
	double t170 = t21*t32;
	double t171 = t20*t35;
	double t172 = t170+t171;
	double t173 = t36*t114;
	double t174 = t102*t114;
	double t175 = t20*t95;
	double t212 = t21*t100;
	double t176 = t175-t212;
	double t177 = t46*t176;
	double t178 = t174+t177;
	double t181 = t12*t15*t53*(2.0/5.0);
	double t182 = t12*t18*t52*(8.3E1/5.0E2);
	double t183 = t11*t12*t15*t53*(8.3E1/5.0E2);
	double t184 = t11*t12*t18*t52*(2.0/5.0);
	double t217 = t9*t14*t53*(8.3E1/5.0E2);
	double t185 = t181+t182+t183+t184-t217;
	double t187 = t12*t18*t53*(8.3E1/5.0E2);
	double t188 = t9*t14*t52*(8.3E1/5.0E2);
	double t189 = t11*t12*t18*t53*(2.0/5.0);
	double t218 = t12*t15*t52*(2.0/5.0);
	double t219 = t11*t12*t15*t52*(8.3E1/5.0E2);
	double t190 = t187+t188+t189-t218-t219;
	double t194 = t19*t122;
	double t195 = t194-t24*t128;
	double t196 = t15*t52*(8.3E1/5.0E2);
	double t197 = t11*t15*t52*(2.0/5.0);
	double t222 = t18*t53*(2.0/5.0);
	double t223 = t11*t18*t53*(8.3E1/5.0E2);
	double t198 = t196+t197-t222-t223;
	double t199 = t19*t131;
	double t200 = t15*t53*(8.3E1/5.0E2);
	double t201 = t18*t52*(2.0/5.0);
	double t202 = t11*t15*t53*(2.0/5.0);
	double t203 = t11*t18*t52*(8.3E1/5.0E2);
	double t204 = t200+t201+t202+t203;
	double t205 = t19*t144;
	double t206 = t24*t147;
	double t207 = t205+t206;
	double t211 = t80*t157;
	double t213 = t80*t161;
	double t214 = t163+t213;
	double t215 = t173-t46*t172;
	double t220 = t20*t125;
	double t221 = t220-t21*t216;
	double t224 = t20*t135;
	double t225 = t224-t21*t138;
	double t226 = t21*t146;
	double t227 = t171+t226;
	double t228 = -t77+t83;
	double t229 = -t104+t108;
	double t233 = t24*t229;
	double t230 = t103-t233;
	double t232 = t24*t228;
	double t231 = t82-t232;
	double t234 = t10*t15*t24;
	double t235 = t15*t17*t19*t20;
	double t236 = t12*t18*t19*t21;
	double t237 = t10*t14*t18*t19*t20;
	double t238 = t19*t228;
	double t239 = t210+t238;
	double t240 = t19*t229;
	double t241 = t158+t240;
	double t242 = t15*t17*t20*t24;
	double t243 = t14*t17*t18*t19;
	double t244 = t12*t18*t21*t24;
	double t245 = t10*t14*t18*t20*t24;
	double t246 = t15*t17*t21;
	double t247 = t10*t14*t18*t21;
	double t248 = t246+t247-t12*t18*t20;
	J.at(0,0) = t51*t154+t85*(t80*t85-t66*t169)+t106*(t163+t80*t106);
	J.at(0,1) = -t51*t215+t157*t168+t161*t178;
	J.at(0,2) = t130*t185-t142*t190-t9*t12*t18*t149*(2.0/5.0);
	J.at(0,3) = t130*t198-t142*t204-t9*t15*t149*(2.0/5.0);
	J.at(0,4) = t9*(t234+t235+t236+t237-t14*t17*t18*t24)*(-8.3E1/5.0E2);
	J.at(0,5) = t9*t12*t17*t24*(-8.3E1/5.0E2)-t9*t14*t19*t21*(8.3E1/5.0E2)-t10*t11*t18*t24*(8.3E1/5.0E2)+t9*t10*t12*t19*t20*(8.3E1/5.0E2)+t11*t12*t15*t19*t21*(8.3E1/5.0E2)-t11*t14*t15*t17*t24*(8.3E1/5.0E2)-t11*t17*t18*t19*t20*(8.3E1/5.0E2)+t10*t11*t14*t15*t19*t20*(8.3E1/5.0E2);
	J.at(1,0) = -t169*(t211-t169*(t65-t107))-t152*t154+t159*t214;
	J.at(1,1) = t159*t178-t168*t169+t152*t215;
	J.at(1,2) = -t185*t195+t190*(t199-t24*t140)-t9*t12*t18*t207*(2.0/5.0);
	J.at(1,3) = -t195*t198+t204*(t199-t24*t140)-t9*t15*t207*(2.0/5.0);
	J.at(1,4) = t9*(t242+t243+t244+t245-t10*t15*t19)*(-8.3E1/5.0E2);
	J.at(1,5) = t9*t12*t17*t19*(8.3E1/5.0E2)+t10*t11*t18*t19*(8.3E1/5.0E2)-t9*t14*t21*t24*(8.3E1/5.0E2)+t9*t10*t12*t20*t24*(8.3E1/5.0E2)+t11*t14*t15*t17*t19*(8.3E1/5.0E2)+t11*t12*t15*t21*t24*(8.3E1/5.0E2)-t11*t17*t18*t20*t24*(8.3E1/5.0E2)+t10*t11*t14*t15*t20*t24*(8.3E1/5.0E2);
	J.at(2,0) = t154*t172+t176*t214+t166*(t211-(t65-t107)*(t155-t210));
	J.at(2,1) = t166*t168+t176*t178-t172*t215;
	J.at(2,2) = t185*t221-t190*t225-t9*t12*t18*t227*(2.0/5.0);
	J.at(2,3) = t198*t221-t204*t225-t9*t15*t227*(2.0/5.0);
	J.at(2,4) = t9*t248*(8.3E1/5.0E2);
	J.at(2,5) = t9*t14*t20*(-8.3E1/5.0E2)-t9*t10*t12*t21*(8.3E1/5.0E2)+t11*t12*t15*t20*(8.3E1/5.0E2)+t11*t17*t18*t21*(8.3E1/5.0E2)-t10*t11*t14*t15*t21*(8.3E1/5.0E2);
	J.at(3,0) = t51*t172+t157*t166+t161*t176;
	J.at(3,1) = -t29*t51+t228*t231+t229*t230;
	J.at(3,2) = t35*t51+t69*t231+t95*t230;
	J.at(3,3) = t61*t231+t93*t230-t9*t18*t51;
	J.at(3,4) = t11*t51+t9*t52*t231-t9*t53*t230;
	J.at(3,5) = -t234-t235-t236-t237+t14*t17*t18*t24;
	J.at(3,6) = t51;
	J.at(4,0) = -t152*t172+t166*t239+t176*t241;
	J.at(4,1) = t29*t152+t228*t239+t229*t241;
	J.at(4,2) = -t35*t152+t69*t239+t95*t241;
	J.at(4,3) = t61*t239+t93*t241+t9*t18*t152;
	J.at(4,4) = -t11*t152+t9*t52*t239-t9*t53*t241;
	J.at(4,5) = -t242-t243-t244-t245+t10*t15*t19;
	J.at(4,6) = -t150-t151;
	J.at(5,0) = t166*t166+t172*t172+t176*t176;
	J.at(5,1) = -t29*t172+t166*t228+t176*t229;
	J.at(5,2) = t35*t172+t69*t166+t95*t176;
	J.at(5,3) = t61*t166+t93*t176-t9*t18*t172;
	J.at(5,4) = t14*t20+t10*t12*t21;
	J.at(5,5) = t248;
	J.at(5,6) = t172;


	return J;
}